<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>World Festival Explorer - Discover 50+ Festivals Worldwide</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
    <style>
        /* ============ RESPONSIVE NAVBAR ============ */

        .navbar {
            background: rgba(109, 40, 217, 0.95);
            backdrop-filter: blur(10px);
            padding: 1rem 1.5rem;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 1000;
            box-shadow: 0 4px 30px rgba(109, 40, 217, 0.2);
            border-bottom: 1px solid rgba(167, 139, 250, 0.2);
        }

        .navbar-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            gap: 1rem;
            flex-wrap: wrap;
        }

        .navbar-brand {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--light);
            text-decoration: none;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .navbar-brand span {
            color: var(--gold-accent);
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
        }

        /* Hamburger Menu Button */
        .hamburger {
            display: none;
            flex-direction: column;
            background: none;
            border: none;
            cursor: pointer;
            gap: 5px;
            padding: 0.5rem;
            z-index: 1001;
        }

        .hamburger span {
            width: 25px;
            height: 3px;
            background-color: var(--light);
            border-radius: 2px;
            transition: all 0.3s ease;
        }

        .hamburger.active span:nth-child(1) {
            transform: rotate(45deg) translate(10px, 10px);
        }

        .hamburger.active span:nth-child(2) {
            opacity: 0;
        }

        .hamburger.active span:nth-child(3) {
            transform: rotate(-45deg) translate(7px, -7px);
        }

        /* Search Bar */
        .search-bar {
            display: flex;
            gap: 0.5rem;
            flex: 1;
            min-width: 200px;
        }

        .search-input {
            flex: 1;
            padding: 0.6rem 1rem;
            border: 1px solid rgba(167, 139, 250, 0.3);
            border-radius: 25px;
            background: rgba(255, 255, 255, 0.1);
            color: var(--light);
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .search-input::placeholder {
            color: rgba(255, 255, 255, 0.6);
        }

        .search-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(167, 139, 250, 0.6);
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.2);
        }

        .search-btn {
            padding: 0.6rem 1.5rem;
            background: linear-gradient(135deg, var(--gold-accent), rgba(212, 175, 55, 0.8));
            border: none;
            border-radius: 25px;
            color: var(--dark-bg);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            white-space: nowrap;
        }

        .search-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.4);
        }

        /* Navigation Links */
        .navbar-nav {
            display: flex;
            list-style: none;
            gap: 0.5rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .nav-link {
            color: var(--light);
            text-decoration: none;
            padding: 0.6rem 1rem;
            border-radius: 20px;
            transition: all 0.3s ease;
            font-weight: 500;
            font-size: 0.95rem;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            white-space: nowrap;
        }

        .nav-link:hover,
        .nav-link.active {
            background: rgba(167, 139, 250, 0.2);
            color: var(--gold-accent);
            text-shadow: 0 0 10px rgba(212, 175, 55, 0.3);
        }

        /* ============ TABLET RESPONSIVE (1024px and below) ============ */
        @media (max-width: 1024px) {
            .navbar {
                padding: 1rem 1rem;
            }

            .search-bar {
                min-width: 150px;
                flex: 0 1 300px;
            }

            .search-input {
                font-size: 0.9rem;
                padding: 0.5rem 0.8rem;
            }

            .search-btn {
                padding: 0.5rem 1rem;
                font-size: 0.9rem;
            }

            .navbar-nav {
                gap: 0.25rem;
            }

            .nav-link {
                padding: 0.5rem 0.8rem;
                font-size: 0.9rem;
            }
        }

        /* ============ MOBILE RESPONSIVE (768px and below) ============ */
        @media (max-width: 768px) {
            .hamburger {
                display: flex;
            }

            .navbar {
                padding: 1rem;
            }

            .navbar-container {
                flex-wrap: nowrap;
                justify-content: space-between;
            }

            .navbar-brand {
                font-size: 1.3rem;
                order: 1;
            }

            .hamburger {
                order: 2;
                margin-left: auto;
            }

            .search-bar {
                order: 3;
                width: 100%;
                margin: 0.8rem 0 0 0;
                flex: unset;
                gap: 0.3rem;
            }

            .search-input {
                font-size: 0.9rem;
                padding: 0.5rem 0.8rem;
            }

            .search-btn {
                padding: 0.5rem 1rem;
                font-size: 0.85rem;
            }

            .navbar-nav {
                order: 4;
                width: calc(100% + 3rem);
                margin-left: -1.5rem;
                margin-right: -1.5rem;
                max-height: 0;
                overflow: hidden;
                flex-direction: column;
                gap: 0;
                background: rgba(109, 40, 217, 0.98);
                border-radius: 0 0 10px 10px;
                transition: max-height 0.3s ease;
                position: relative;
                z-index: 999;
            }

            .navbar-nav.active {
                max-height: 500px;
                border-top: 1px solid rgba(167, 139, 250, 0.2);
            }

            .nav-link {
                width: 100%;
                padding: 0.75rem 1.5rem;
                border-radius: 0;
                border-bottom: 1px solid rgba(167, 139, 250, 0.1);
                justify-content: flex-start;
            }

            .nav-link:last-child {
                border-bottom: none;
            }
        }

        /* ============ SMALL MOBILE (480px and below) ============ */
        @media (max-width: 480px) {
            .navbar {
                padding: 0.8rem 0.5rem;
            }

            .navbar-brand {
                font-size: 1.1rem;
            }

            .search-bar {
                gap: 0.2rem;
            }

            .search-input {
                font-size: 0.85rem;
                padding: 0.4rem 0.6rem;
            }

            .search-btn {
                padding: 0.4rem 0.7rem;
                font-size: 0.8rem;
            }

            .hamburger span {
                width: 20px;
                height: 2.5px;
            }

            .nav-link {
                font-size: 0.85rem;
                padding: 0.6rem 1rem;
            }

            .nav-link i {
                display: none;
            }
        }

        /* ============ EXTRA SMALL (Below 360px) ============ */
        @media (max-width: 360px) {
            .navbar-brand {
                font-size: 1rem;
            }

            .search-input::placeholder {
                font-size: 0.75rem;
            }

            .nav-link {
                font-size: 0.8rem;
                padding: 0.5rem;
            }
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-purple: #6D28D9;
            --accent-purple: #A78BFA;
            --dark-purple: #2D1B69;
            --soft-lavender: #EDE9FE;
            --gold-accent: #D4AF37;
            --primary-orange: #D2691E;
            --coral: #E17055;
            --success-green: #1E7E34;
            --dark-bg: #0F0A1C;
            --light-bg: #F8F7F5;
            --white: #FFFFFF;
            --dark-text: #1A1A1A;
            --gray-text: #6B7280;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, var(--light-bg) 0%, #FAF8FF 100%);
            color: var(--dark-text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        h1, h2, h3 {
            font-family: 'Playfair Display', serif;
        }

        /* Smooth scrolling */
        html {
            scroll-behavior: smooth;
        }

        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes gradientShift {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-10px); }
        }

        .fade-in {
            animation: fadeInUp 0.6s ease-out;
        }

        /* Navbar Styles */
        .main-content {
            margin-top: 80px;
            min-height: calc(100vh - 160px);
        }

        .page {
            display: none;
        }

        .page.active {
            display: block;
        }

        /* Home Page */
        .hero {
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--dark-purple) 50%, var(--gold-accent) 100%);
            background-size: 200% 200%;
            animation: gradientShift 8s ease infinite;
            color: white;
            padding: 6rem 2rem;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 50% 50%, rgba(167, 139, 250, 0.2) 0%, transparent 70%);
            animation: pulse 4s ease-in-out infinite;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            font-weight: 900;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
            letter-spacing: -1px;
            position: relative;
            z-index: 1;
        }

        .hero p {
            font-size: 1.25rem;
            margin-bottom: 2rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
        }

        .hero-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 5px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--accent-purple) 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(109, 40, 217, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(109, 40, 217, 0.5);
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            color: var(--primary-purple);
            border: 2px solid rgba(255, 255, 255, 0.3);
        }

        .btn-secondary:hover {
            background: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(255, 255, 255, 0.4);
        }

        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            padding: 3rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 2rem;
            border-radius: 20px;
            text-align: center;
            box-shadow: 0 8px 32px rgba(109, 40, 217, 0.1);
            border: 1px solid rgba(167, 139, 250, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-purple), var(--accent-purple), var(--gold-accent));
        }

        .stat-card:hover {
            transform: translateY(-10px) scale(1.05);
            box-shadow: 0 15px 40px rgba(109, 40, 217, 0.25);
        }

        .stat-number {
            font-size: 3rem;
            font-weight: 900;
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--mid-gray);
            margin-top: 0.5rem;
        }

        .featured-section {
            padding: 3rem 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .section-title {
            font-size: 2.5rem;
            margin-bottom: 2rem;
            text-align: center;
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-weight: 900;
            letter-spacing: -1px;
        }

        /* Festival Cards */
        .festival-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 2rem;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .festival-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 8px 32px rgba(109, 40, 217, 0.12);
            border: 1px solid rgba(167, 139, 250, 0.2);
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            cursor: pointer;
            position: relative;
        }

        .festival-card::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(109, 40, 217, 0.1) 0%, rgba(167, 139, 250, 0.1) 100%);
            opacity: 0;
            transition: opacity 0.3s;
            pointer-events: none;
        }

        .festival-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 50px rgba(109, 40, 217, 0.25);
        }

        .festival-card:hover::after {
            opacity: 1;
        }

        .festival-image {
            width: 100%;
            height: 220px;
            object-fit: cover;
            transition: transform 0.5s;
            position: relative;
        }

        .festival-card:hover .festival-image {
            transform: scale(1.1);
        }

        .festival-content {
            padding: 1.5rem;
        }

        .festival-name {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-purple);
            margin-bottom: 0.5rem;
            font-family: 'Playfair Display', serif;
        }

        .festival-location {
            color: var(--mid-gray);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .festival-month {
            display: inline-block;
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-purple));
            color: white;
            padding: 0.3rem 0.9rem;
            border-radius: 20px;
            font-size: 0.875rem;
            margin-bottom: 0.5rem;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(109, 40, 217, 0.3);
        }

        .continent-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 15px;
            font-size: 0.875rem;
            font-weight: 500;
        }

        .continent-asia { background-color: #FFE5B4; color: #8B4513; }
        .continent-europe { background-color: #E0F7FA; color: #006064; }
        .continent-africa { background-color: #FFF3E0; color: #E65100; }
        .continent-americas { background-color: #F3E5F5; color: #4A148C; }
        .continent-oceania { background-color: #E8F5E9; color: #1B5E20; }

        .festival-description {
            color: var(--dark);
            font-size: 0.9rem;
            margin-bottom: 1rem;
            line-height: 1.5;
        }

        /* Pagination */
        .pagination {
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            padding: 2rem;
            flex-wrap: wrap;
        }

        .pagination-btn {
            padding: 0.6rem 1.2rem;
            border: 2px solid var(--accent-purple);
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            color: var(--primary-purple);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .pagination-btn:hover {
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-purple));
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(109, 40, 217, 0.3);
        }

        .pagination-btn.active {
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-purple));
            color: white;
            box-shadow: 0 4px 15px rgba(109, 40, 217, 0.3);
        }

        .pagination-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* Filter Section */
        .filter-section {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .filter-select {
            padding: 0.7rem 1.2rem;
            border: 2px solid var(--accent-purple);
            border-radius: 25px;
            font-size: 1rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            cursor: pointer;
            transition: all 0.3s;
            color: var(--primary-purple);
            font-weight: 600;
        }

        .filter-select:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(167, 139, 250, 0.3);
            border-color: var(--primary-purple);
        }

        /* Timeline */
        .timeline-container {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .timeline {
            position: relative;
        }

        .timeline-month {
            margin-bottom: 3rem;
        }

        .month-header {
            font-size: 2rem;
            font-weight: 900;
            color: var(--primary-purple);
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            border-bottom: 4px solid transparent;
            border-image: linear-gradient(90deg, var(--primary-purple), var(--accent-purple), var(--gold-accent));
            border-image-slice: 1;
            font-family: 'Playfair Display', serif;
        }

        .timeline-items {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .timeline-item {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 15px;
            border-left: 5px solid var(--primary-purple);
            box-shadow: 0 4px 20px rgba(109, 40, 217, 0.1);
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            border: 1px solid rgba(167, 139, 250, 0.15);
        }

        .timeline-item:hover {
            transform: translateX(10px) scale(1.02);
            box-shadow: 0 8px 30px rgba(109, 40, 217, 0.25);
            border-left-color: var(--accent-purple);
        }

        .timeline-item-name {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--primary-purple);
            margin-bottom: 0.5rem;
            font-family: 'Playfair Display', serif;
        }

        .timeline-item-location {
            color: var(--mid-gray);
            font-size: 0.9rem;
        }

        /* Map */
        .map-container {
            padding: 2rem;
            padding-top: 1rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        #map {
            height: 600px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .map-controls {
            margin-bottom: 1rem;
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        /* Festival Detail Modal */
        .modal {
            display: none;
            position: fixed;
            z-index: 2000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.6);
        }

        .modal.active {
            display: block;
        }

        .modal-content {
            background: rgba(255, 255, 255, 0.98);
            backdrop-filter: blur(20px);
            margin: 5% auto;
            padding: 0;
            border-radius: 24px;
            max-width: 800px;
            box-shadow: 0 20px 60px rgba(109, 40, 217, 0.3);
            border: 1px solid rgba(167, 139, 250, 0.3);
            position: relative;
            animation: slideDown 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-50px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .modal-header {
            position: relative;
            height: 300px;
            overflow: hidden;
            border-radius: 10px 10px 0 0;
        }

        .modal-header img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .close-modal {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background-color: white;
            color: var(--dark);
            border: none;
            font-size: 2rem;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.2);
            transition: all 0.3s;
        }

        .close-modal:hover {
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-purple));
            color: white;
            transform: rotate(90deg) scale(1.1);
        }

        .modal-body {
            padding: 2rem;
        }

        .modal-title {
            font-size: 2.25rem;
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-purple));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            font-weight: 900;
            font-family: 'Playfair Display', serif;
        }

        .modal-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .info-item {
            background: linear-gradient(135deg, rgba(237, 233, 254, 0.5), rgba(255, 255, 255, 0.8));
            padding: 1.2rem;
            border-radius: 12px;
            border: 1px solid rgba(167, 139, 250, 0.2);
            transition: all 0.3s;
        }

        .info-item:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(109, 40, 217, 0.15);
        }

        .info-label {
            font-weight: 700;
            color: var(--gray-text);
            font-size: 0.75rem;
            margin-bottom: 0.25rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .info-value {
            font-size: 1.1rem;
            color: var(--primary-purple);
            font-weight: 600;
        }

        .modal-section {
            margin-bottom: 1.5rem;
        }

        .modal-section h3 {
            font-size: 1.4rem;
            color: var(--primary-purple);
            margin-bottom: 0.75rem;
            font-weight: 700;
            font-family: 'Playfair Display', serif;
        }

        .activities-list {
            display: flex;
            flex-wrap: wrap;
            gap: 0.5rem;
        }

        .activity-tag {
            background: linear-gradient(135deg, var(--accent-purple), var(--primary-purple));
            color: white;
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            box-shadow: 0 2px 8px rgba(109, 40, 217, 0.25);
            transition: all 0.3s;
        }

        .activity-tag:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(109, 40, 217, 0.4);
        }

        .modal-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }

        /* Search Results */
        .no-results {
            text-align: center;
            padding: 3rem;
            font-size: 1.25rem;
            color: var(--mid-gray);
        }

        /* Compare Section */
        .compare-container {
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .compare-selection {
            margin-bottom: 2rem;
        }

        .compare-selects {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .compare-table {
            width: 100%;
            background: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .compare-table table {
            width: 100%;
            border-collapse: collapse;
        }

        .compare-table th,
        .compare-table td {
            padding: 1rem;
            text-align: left;
            border-bottom: 1px solid var(--light-gray);
        }

        .compare-table th {
            background-color: var(--accent-deep);
            color: white;
            font-weight: bold;
        }

        .compare-table tr:hover {
            background-color: var(--light);
        }

        /* Footer */
        .footer {
            background: linear-gradient(135deg, var(--dark-purple) 0%, var(--dark-bg) 100%);
            color: var(--soft-lavender);
            padding: 3rem 2rem;
            text-align: center;
            margin-top: 4rem;
            border-top: 2px solid var(--primary-purple);
        }

        .footer-content {
            max-width: 1400px;
            margin: 0 auto;
        }

        .footer p {
            margin-bottom: 0.5rem;
        }

        .footer a {
            color: var(--gold-accent);
            text-decoration: none;
            transition: all 0.3s;
        }

        .footer a:hover {
            color: var(--accent-purple);
            text-shadow: 0 0 10px rgba(167, 139, 250, 0.5);
        }

        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2rem;
            }

            .hero p {
                font-size: 1rem;
            }

            .festival-grid {
                grid-template-columns: 1fr;
            }

            #map {
                height: 400px;
            }

            .modal-content {
                margin: 2% 5%;
                max-width: 90%;
            }
        }

        /* Loading State */
        .loading {
            text-align: center;
            padding: 3rem;
            font-size: 1.25rem;
            color: var(--mid-gray);
        }

        /* Leaflet custom styles */
        .leaflet-popup-content-wrapper {
            border-radius: 8px;
        }

        .popup-content {
            text-align: center;
        }

        .popup-content h4 {
            color: var(--accent-deep);
            margin-bottom: 0.5rem;
        }

        .popup-content p {
            color: var(--mid-gray);
            font-size: 0.9rem;
            margin-bottom: 0.5rem;
        }

        .popup-btn {
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-purple));
            color: white;
            padding: 0.6rem 1.2rem;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            transition: all 0.3s;
        }

        .popup-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 12px rgba(109, 40, 217, 0.4);
        }

        /* Custom marker colors */
        .marker-cluster-small {
            background-color: rgba(167, 139, 250, 0.6);
        }

        .marker-cluster-small div {
            background-color: rgba(109, 40, 217, 0.8);
        }

        .marker-cluster-medium {
            background-color: rgba(167, 139, 250, 0.6);
        }

        .marker-cluster-medium div {
            background-color: rgba(109, 40, 217, 0.8);
        }

        .marker-cluster-large {
            background-color: rgba(167, 139, 250, 0.6);
        }

        .marker-cluster-large div {
            background-color: rgba(109, 40, 217, 0.8);
        }

        /* Back to Top Button */
        .back-to-top {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, var(--primary-purple), var(--accent-purple));
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            display: none;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            box-shadow: 0 4px 20px rgba(109, 40, 217, 0.4);
            transition: all 0.3s;
            z-index: 999;
        }

        .back-to-top:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(109, 40, 217, 0.6);
        }

        .back-to-top.show {
            display: flex;
        }

        /* Favorites Heart Button */
        .favorite-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            z-index: 10;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
        }

        .favorite-btn:hover {
            transform: scale(1.15);
        }

        .favorite-btn.active {
            background: linear-gradient(135deg, #FF6B9D, #C73866);
        }

        .favorite-btn i {
            color: var(--primary-purple);
            font-size: 1.2rem;
        }

        .favorite-btn.active i {
            color: white;
        }

        /* Category Badge */
        .category-badge {
            position: absolute;
            top: 1rem;
            left: 1rem;
            background: rgba(109, 40, 217, 0.95);
            backdrop-filter: blur(10px);
            color: white;
            padding: 0.4rem 0.9rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            z-index: 10;
            box-shadow: 0 2px 10px rgba(109, 40, 217, 0.4);
        }

        /* Newsletter Modal */
        .newsletter-modal {
            display: none;
            position: fixed;
            z-index: 2001;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(15, 10, 28, 0.8);
            backdrop-filter: blur(5px);
        }

        .newsletter-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .newsletter-content {
            background: linear-gradient(135deg, var(--primary-purple) 0%, var(--dark-purple) 100%);
            padding: 3rem;
            border-radius: 24px;
            max-width: 500px;
            text-align: center;
            color: white;
            box-shadow: 0 20px 60px rgba(109, 40, 217, 0.5);
            border: 1px solid rgba(167, 139, 250, 0.3);
            animation: slideDown 0.4s ease-out;
        }

        .newsletter-content h2 {
            font-size: 2rem;
            margin-bottom: 1rem;
            font-family: 'Playfair Display', serif;
        }

        .newsletter-content p {
            margin-bottom: 1.5rem;
            opacity: 0.9;
        }

        .newsletter-input {
            width: 100%;
            padding: 1rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            color: white;
            font-size: 1rem;
            margin-bottom: 1rem;
        }

        .newsletter-input::placeholder {
            color: rgba(255, 255, 255, 0.7);
        }

        .newsletter-input:focus {
            outline: none;
            border-color: var(--gold-accent);
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <button class="hamburger" id="hamburgerBtn" aria-label="Toggle navigation">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <div class="navbar-container">
            <a href="#" class="navbar-brand" onclick="showPage('home')">
                Culture<span>Connect</span>
            </a>
            <div class="search-bar">
                <input type="text" class="search-input" id="globalSearch" placeholder="Search festivals by name, country, or month...">
                <button class="search-btn" onclick="performSearch()">Search</button>
            </div>
            <ul class="navbar-nav">
                <li><a href="#" class="nav-link active" onclick="showPage('home')">Home</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('gallery')">Festival Gallery</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('timeline')">Timeline</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('map')">Map</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('compare')">Compare</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('favorites')"><i class="fas fa-heart"></i> Favorites</a></li>
                <li><a href="#" class="nav-link" onclick="showPage('planner')"><i class="fas fa-calendar-check"></i> Planner</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="main-content">
        <!-- Home Page -->
        <div id="home" class="page active">
            <div class="hero">
                <h1>Explore 50+ World Festivals</h1>
                <p>Discover cultural celebrations from every continent. Plan your next adventure!</p>
                <div class="hero-buttons">
                    <button class="btn btn-primary" onclick="showPage('gallery')">Browse Festivals</button>
                    <button class="btn btn-secondary" onclick="showPage('map')">View Map</button>
                </div>
            </div>

            <div class="stats">
                <div class="stat-card">
                    <div class="stat-number">50+</div>
                    <div class="stat-label">Festivals</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">35+</div>
                    <div class="stat-label">Countries</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">5</div>
                    <div class="stat-label">Continents</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number">12</div>
                    <div class="stat-label">Months</div>
                </div>
            </div>

            <div class="featured-section">
                <h2 class="section-title">Featured Festivals</h2>
                <div class="festival-grid" id="featuredFestivals"></div>
            </div>
        </div>

        <!-- Gallery Page -->
        <div id="gallery" class="page">
            <div class="featured-section">
                <h2 class="section-title">Festival Gallery</h2>
                
                <div class="filter-section">
                    <select class="filter-select" id="continentFilter" onchange="applyFilters()">
                        <option value="all">All Continents</option>
                        <option value="Asia">Asia</option>
                        <option value="Europe">Europe</option>
                        <option value="Africa">Africa</option>
                        <option value="Americas">Americas</option>
                        <option value="Oceania">Oceania</option>
                    </select>
                    <select class="filter-select" id="monthFilter" onchange="applyFilters()">
                        <option value="all">All Months</option>
                        <option value="1">January</option>
                        <option value="2">February</option>
                        <option value="3">March</option>
                        <option value="4">April</option>
                        <option value="5">May</option>
                        <option value="6">June</option>
                        <option value="7">July</option>
                        <option value="8">August</option>
                        <option value="9">September</option>
                        <option value="10">October</option>
                        <option value="11">November</option>
                        <option value="12">December</option>
                    </select>
                </div>

                <div class="festival-grid" id="galleryFestivals"></div>
                <div class="pagination" id="pagination"></div>
            </div>
        </div>

        <!-- Timeline Page -->
        <div id="timeline" class="page">
            <div class="timeline-container">
                <h2 class="section-title">Festival Timeline</h2>
                <div class="timeline" id="timelineContent"></div>
            </div>
        </div>

        <!-- Map Page -->
        <div id="map-page" class="page">
            <div class="map-container">
                <h2 class="section-title">Festival Locations</h2>
                <div class="map-controls">
                    <select class="filter-select" id="mapContinentFilter" onchange="filterMapMarkers()">
                        <option value="all">All Continents</option>
                        <option value="Asia">Asia</option>
                        <option value="Europe">Europe</option>
                        <option value="Africa">Africa</option>
                        <option value="Americas">Americas</option>
                        <option value="Oceania">Oceania</option>
                    </select>
                </div>
                <div id="map"></div>
            </div>
        </div>

        <!-- Compare Page -->
        <div id="compare" class="page">
            <div class="compare-container">
                <h2 class="section-title">Compare Festivals</h2>
                
                <div class="compare-selection">
                    <h3>Select festivals to compare:</h3>
                    <div class="compare-selects">
                        <select class="filter-select" id="compare1" onchange="updateComparison()">
                            <option value="">Select Festival 1</option>
                        </select>
                        <select class="filter-select" id="compare2" onchange="updateComparison()">
                            <option value="">Select Festival 2</option>
                        </select>
                        <select class="filter-select" id="compare3" onchange="updateComparison()">
                            <option value="">Select Festival 3 (Optional)</option>
                        </select>
                    </div>
                </div>

                <div class="compare-table" id="comparisonTable"></div>
            </div>
        </div>

        <!-- Search Results Page -->
        <div id="search-results" class="page">
            <div class="search-results">
                <div class="search-header">
                    <h2 class="section-title">Search Results</h2>
                    <p>Showing results for: <span class="search-term" id="searchTerm"></span></p>
                </div>
                <div class="festival-grid" id="searchResultsGrid"></div>
            </div>
        </div>

        <!-- Favorites Page -->
        <div id="favorites" class="page">
            <div class="featured-section">
                <h2 class="section-title"><i class="fas fa-heart" style="color: #FF6B9D;"></i> My Favorites</h2>
                <p style="text-align: center; color: var(--gray-text); margin-bottom: 2rem;">Your collection of favorite festivals from around the world</p>
                <div class="festival-grid" id="favoritesGrid"></div>
            </div>
        </div>

        <!-- Planner Page -->
        <div id="planner" class="page">
            <div class="featured-section">
                <h2 class="section-title"><i class="fas fa-calendar-check"></i> Festival Planner</h2>
                <p style="text-align: center; color: var(--gray-text); margin-bottom: 2rem;">Plan your festival journey and create your dream itinerary</p>
                <div class="planner-stats" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1.5rem; margin-bottom: 2rem;">
                    <div class="stat-card">
                        <div class="stat-number" id="plannedCount">0</div>
                        <div class="stat-label">Festivals Planned</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="countriesCount">0</div>
                        <div class="stat-label">Countries</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="continentsCount">0</div>
                        <div class="stat-label">Continents</div>
                    </div>
                </div>
                <div class="festival-grid" id="plannerGrid"></div>
            </div>
        </div>
    </div>

    <!-- Back to Top Button -->
    <button class="back-to-top" id="backToTop" onclick="scrollToTop()">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Newsletter Modal -->
    <div id="newsletterModal" class="newsletter-modal">
        <div class="newsletter-content">
            <h2>✨ Stay Updated!</h2>
            <p>Join our community and get notified about new festivals and exclusive travel tips!</p>
            <input type="email" class="newsletter-input" placeholder="Enter your email" id="newsletterEmail">
            <div style="display: flex; gap: 1rem; justify-content: center;">
                <button class="btn btn-primary" onclick="subscribeNewsletter()" style="flex: 1;">Subscribe</button>
                <button class="btn btn-secondary" onclick="closeNewsletterModal()" style="flex: 1;">Maybe Later</button>
            </div>
        </div>
    </div>

    <!-- Festival Detail Modal -->
    <div id="festivalModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <img id="modalImage" src="" alt="Festival">
                <button class="close-modal" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <h2 class="modal-title" id="modalTitle"></h2>
                
                <div class="modal-info">
                    <div class="info-item">
                        <div class="info-label">Country</div>
                        <div class="info-value" id="modalCountry"></div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Continent</div>
                        <div class="info-value" id="modalContinent"></div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Month</div>
                        <div class="info-value" id="modalMonth"></div>
                    </div>
                    <div class="info-item">
                        <div class="info-label">Coordinates</div>
                        <div class="info-value" id="modalCoordinates"></div>
                    </div>
                </div>

                <div class="modal-section">
                    <h3>Significance</h3>
                    <p id="modalSignificance"></p>
                </div>

                <div class="modal-section">
                    <h3>Activities &amp; Traditions</h3>
                    <div class="activities-list" id="modalActivities"></div>
                </div>

                <div class="modal-actions">
                    <button class="btn btn-primary" onclick="showOnMap()">View on Map</button>
                    <button class="btn btn-secondary" onclick="closeModal()">Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <p>&copy; 2025 Festival Explorer. All rights reserved.</p>
            <p>Discover cultural celebrations from around the world.</p>
            <p>Made with ❤️ for festival enthusiasts worldwide</p>
        </div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
    <script>

            // Hamburger menu toggle
            const hamburgerBtn = document.getElementById('hamburgerBtn');
            const navbarNav = document.querySelector('.navbar-nav');

            if (hamburgerBtn) {
                hamburgerBtn.addEventListener('click', function() {
                    hamburgerBtn.classList.toggle('active');
                    navbarNav.classList.toggle('active');
                });

                // Close menu when a link is clicked
                const navLinks = navbarNav.querySelectorAll('.nav-link');
                navLinks.forEach(link => {
                    link.addEventListener('click', function() {
                        hamburgerBtn.classList.remove('active');
                        navbarNav.classList.remove('active');
                    });
                });

                // Close menu when clicking outside
                document.addEventListener('click', function(event) {
                    if (!document.querySelector('.navbar').contains(event.target)) {
                        if (hamburgerBtn.classList.contains('active')) {
                            hamburgerBtn.classList.remove('active');
                            navbarNav.classList.remove('active');
                        }
                    }
                });
            }
        // Festival Data
        const festivals = [
            {id: 1, name: "Holi", country: "India", continent: "Asia", month: 3, coordinates: [20.5937, 78.9629], image: "https://images.unsplash.com/photo-1577720643272-265e434ff998?w=500&h=400&fit=crop", activities: ["Color throwing", "Bonfire", "Sweets"], significance: "Victory of good over evil"},
            {id: 2, name: "Diwali", country: "India", continent: "Asia", month: 10, coordinates: [20.5937, 78.9629], image: "https://images.unsplash.com/photo-1599707346992-018e047cabf1?w=500&h=400&fit=crop", activities: ["Lighting diyas", "Fireworks", "Feasting"], significance: "Festival of Lights"},
            {id: 3, name: "Chinese New Year", country: "China", continent: "Asia", month: 2, coordinates: [35.8617, 104.1954], image: "https://images.unsplash.com/photo-1579833971457-24d1e7a37f60?w=500&h=400&fit=crop", activities: ["Dragon dances", "Fireworks", "Family reunions"], significance: "Lunar New Year celebration"},
            {id: 4, name: "Songkran", country: "Thailand", continent: "Asia", month: 4, coordinates: [15.8700, 100.9925], image: "https://images.unsplash.com/photo-1504384308090-c894fdcc538d?w=500&h=400&fit=crop", activities: ["Water battles", "Temple visits", "Parades"], significance: "Thai New Year"},
            {id: 5, name: "Tanabata", country: "Japan", continent: "Asia", month: 7, coordinates: [36.2048, 138.2529], image: "https://images.unsplash.com/photo-1522027169507-c4b4f4ee2b04?w=500&h=400&fit=crop", activities: ["Bamboo wishes", "Lanterns", "Dancing"], significance: "Star-crossed lovers festival"},
            {id: 6, name: "Hajj", country: "Saudi Arabia", continent: "Asia", month: 6, coordinates: [21.4225, 39.8262], image: "https://images.unsplash.com/photo-1573918851895-b50dc4fb3010?w=500&h=400&fit=crop", activities: ["Pilgrimage", "Prayer", "Gathering"], significance: "Islamic holy pilgrimage"},
            {id: 7, name: "Thaipusam", country: "Malaysia", continent: "Asia", month: 1, coordinates: [3.1390, 101.6869], image: "https://images.unsplash.com/photo-1559827260-dc66d52bef19?w=500&h=400&fit=crop", activities: ["Processions", "Body piercing", "Temple visits"], significance: "Hindu devotional festival"},
            {id: 8, name: "Navaratri", country: "India", continent: "Asia", month: 9, coordinates: [20.5937, 78.9629], image: "https://images.unsplash.com/photo-1531746020798-e6953c6e8e04?w=500&h=400&fit=crop", activities: ["Garba dancing", "Fasting", "Rituals"], significance: "Victory of good over evil"},
            {id: 9, name: "Mid-Autumn Festival", country: "China", continent: "Asia", month: 9, coordinates: [35.8617, 104.1954], image: "https://images.unsplash.com/photo-1549317661-bd32c8e6e770?w=500&h=400&fit=crop", activities: ["Lantern displays", "Moon gazing", "Family gatherings"], significance: "Harvest and reunion celebration"},
            {id: 10, name: "Raksha Bandhan", country: "India", continent: "Asia", month: 8, coordinates: [20.5937, 78.9629], image: "https://images.unsplash.com/photo-1552456537-bcb305c4b773?w=500&h=400&fit=crop", activities: ["Tying rakhis", "Sweets", "Prayers"], significance: "Brother-sister bond celebration"},
            {id: 11, name: "Janmashtami", country: "India", continent: "Asia", month: 8, coordinates: [20.5937, 78.9629], image: "https://images.unsplash.com/photo-1605080945090-e221ef2d31aa?w=500&h=400&fit=crop", activities: ["Temple visits", "Butter offerings", "Fasting"], significance: "Birth of Lord Krishna"},
            {id: 12, name: "Onam", country: "India", continent: "Asia", month: 8, coordinates: [10.8505, 76.2711], image: "https://images.unsplash.com/photo-1517899291350-e3a6f5f25dd6?w=500&h=400&fit=crop", activities: ["Flower rangoli", "Boat races", "Feasting"], significance: "Harvest festival of Kerala"},
            {id: 13, name: "Gudi Padwa", country: "India", continent: "Asia", month: 3, coordinates: [20.5937, 78.9629], image: "https://images.unsplash.com/photo-1599707346994-2e8ad8b08b4e?w=500&h=400&fit=crop", activities: ["Gudi hoisting", "Traditional dishes", "Gatherings"], significance: "Marathi New Year"},
            {id: 14, name: "Tet Festival", country: "Vietnam", continent: "Asia", month: 2, coordinates: [14.0583, 108.2772], image: "https://images.unsplash.com/photo-1523821741446-edb429f67505?w=500&h=400&fit=crop", activities: ["Family reunions", "Fireworks", "Traditional foods"], significance: "Vietnamese New Year"},
            {id: 15, name: "Baisakhi", country: "India", continent: "Asia", month: 4, coordinates: [31.7683, 74.8670], image: "https://images.unsplash.com/photo-1598103442097-8b74394b95c6?w=500&h=400&fit=crop", activities: ["Bonfire", "New clothes", "Traditional dances"], significance: "Harvest and Sikh New Year"},
            {id: 16, name: "Oktoberfest", country: "Germany", continent: "Europe", month: 9, coordinates: [48.1351, 11.5820], image: "https://images.unsplash.com/photo-1535632066927-ab7c9ab60908?w=500&h=400&fit=crop", activities: ["Beer drinking", "Bavarian food", "Music"], significance: "World's largest beer festival"},
            {id: 17, name: "Carnival of Venice", country: "Italy", continent: "Europe", month: 2, coordinates: [45.4408, 12.3155], image: "https://images.unsplash.com/photo-1509631179647-0177331693ae?w=500&h=400&fit=crop", activities: ["Masquerade balls", "Parades", "Street performances"], significance: "Historic masquerade festival"},
            {id: 18, name: "Hogmanay", country: "Scotland", continent: "Europe", month: 12, coordinates: [55.9533, -3.1883], image: "https://images.unsplash.com/photo-1478721471782-7c5baa4166c7?w=500&h=400&fit=crop", activities: ["Street parties", "Fireworks", "First footing"], significance: "Scottish New Year celebration"},
            {id: 19, name: "La Tomatina", country: "Spain", continent: "Europe", month: 8, coordinates: [39.2719, -0.7627], image: "https://images.unsplash.com/photo-1516562141207-8caab60bd798?w=500&h=400&fit=crop", activities: ["Tomato throwing", "Water fights", "Street parties"], significance: "World's largest food fight festival"},
            {id: 20, name: "Running of the Bulls", country: "Spain", continent: "Europe", month: 7, coordinates: [42.8597, -1.6432], image: "https://images.unsplash.com/photo-1533900298318-6b8da08a523e?w=500&h=400&fit=crop", activities: ["Bull runs", "Fiestas", "Street celebrations"], significance: "Famous Spanish bull running event"},
            {id: 21, name: "Celtic Festival", country: "Scotland", continent: "Europe", month: 8, coordinates: [56.0196, -3.1910], image: "https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=500&h=400&fit=crop", activities: ["Traditional music", "Dance", "Highland games"], significance: "Cultural celebration of Celtic heritage"},
            {id: 22, name: "Notting Hill Carnival", country: "United Kingdom", continent: "Europe", month: 8, coordinates: [51.5091, -0.2092], image: "https://images.unsplash.com/photo-1492684223066-81342ee5ff30?w=500&h=400&fit=crop", activities: ["Parades", "Music", "Caribbean food"], significance: "Largest Caribbean street festival in Europe"},
            {id: 23, name: "Edinburgh Festival", country: "Scotland", continent: "Europe", month: 8, coordinates: [55.9533, -3.1883], image: "https://images.unsplash.com/photo-1460749411175-04bf5292ceea?w=500&h=400&fit=crop", activities: ["Theatre", "Comedy", "Music performances"], significance: "World's largest arts festival"},
            {id: 24, name: "Durban July", country: "South Africa", continent: "Africa", month: 7, coordinates: [-29.8587, 31.0292], image: "https://images.unsplash.com/photo-1479142506370-56aeb00c5d14?w=500&h=400&fit=crop", activities: ["Horse racing", "Fashion", "Socializing"], significance: "South Africa's most famous horse racing event"},
            {id: 25, name: "Festival au Désert", country: "Mali", continent: "Africa", month: 1, coordinates: [16.2565, -3.0056], image: "https://images.unsplash.com/photo-1493225457124-a3eb161ffa5f?w=500&h=400&fit=crop", activities: ["Music", "Tuareg culture", "Traditional dance"], significance: "Celebration of Tuareg culture and music"},
            {id: 26, name: "Zanzibar Film Festival", country: "Tanzania", continent: "Africa", month: 7, coordinates: [-6.1667, 39.1667], image: "https://images.unsplash.com/photo-1489749798305-4fea3ba63d60?w=500&h=400&fit=crop", activities: ["Film screenings", "Discussions", "Cultural events"], significance: "African and world cinema celebration"},
            {id: 27, name: "Cape Town Festival", country: "South Africa", continent: "Africa", month: 3, coordinates: [-33.9249, 18.4241], image: "https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=500&h=400&fit=crop", activities: ["Music", "Street art", "Cultural performances"], significance: "Multi-genre festival celebrating Cape Town culture"},
            {id: 28, name: "Abodje Festival", country: "Benin", continent: "Africa", month: 6, coordinates: [6.4969, 2.6289], image: "https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=500&h=400&fit=crop", activities: ["Traditional rituals", "Dance", "Music"], significance: "Celebration of Yoruba royalty and culture"},
            {id: 29, name: "Gerewol Festival", country: "Niger", continent: "Africa", month: 9, coordinates: [16.6369, 5.5197], image: "https://images.unsplash.com/photo-1504126613408-eca07ce68773?w=500&h=400&fit=crop", activities: ["Male beauty contest", "Dance", "Courtship rituals"], significance: "Fulani ethnic celebration and gathering"},
            {id: 30, name: "Timkat Festival", country: "Ethiopia", continent: "Africa", month: 1, coordinates: [9.0320, 38.7469], image: "https://images.unsplash.com/photo-1525763185298-1b434c919eba?w=500&h=400&fit=crop", activities: ["Religious processions", "Baptism reenactment", "Prayers"], significance: "Epiphany celebration and religious observance"},
            {id: 31, name: "Carnival Rio", country: "Brazil", continent: "Americas", month: 2, coordinates: [-22.9068, -43.1729], image: "https://images.unsplash.com/photo-1579727899923-5c2e9b5e9797?w=500&h=400&fit=crop", activities: ["Samba dancing", "Costumes", "Parades"], significance: "World's largest carnival celebration"},
            {id: 32, name: "Mardi Gras", country: "USA", continent: "Americas", month: 2, coordinates: [29.9511, -90.2623], image: "https://images.unsplash.com/photo-1514306688737-6ad76b1991c5?w=500&h=400&fit=crop", activities: ["Parades", "Masquerade", "Street parties"], significance: "New Orleans carnival celebration"},
            {id: 33, name: "Day of Dead", country: "Mexico", continent: "Americas", month: 11, coordinates: [19.4326, -99.1332], image: "https://images.unsplash.com/photo-1489749798305-4fea3ba63d60?w=500&h=400&fit=crop", activities: ["Altar building", "Cemetery visits", "Feasting"], significance: "Remembrance of deceased loved ones"},
            {id: 34, name: "Burning Man", country: "USA", continent: "Americas", month: 8, coordinates: [40.7842, -119.0881], image: "https://images.unsplash.com/photo-1498855926480-d98e83099315?w=500&h=400&fit=crop", activities: ["Art installations", "Music", "Community building"], significance: "Large-scale participatory art festival"},
            {id: 35, name: "Coachella", country: "USA", continent: "Americas", month: 4, coordinates: [33.6837, -116.2413], image: "https://images.unsplash.com/photo-1519671482677-5a0b5acd2172?w=500&h=400&fit=crop", activities: ["Music performances", "Art", "Fashion"], significance: "Major music and arts festival"},
            {id: 36, name: "South by Southwest", country: "USA", continent: "Americas", month: 3, coordinates: [30.2672, -97.7431], image: "https://images.unsplash.com/photo-1470225620780-dba8ba36b745?w=500&h=400&fit=crop", activities: ["Music", "Film", "Interactive media"], significance: "Film, interactive media and music conference and festival"},
            {id: 37, name: "Las Fiestas Patrias", country: "Chile", continent: "Americas", month: 9, coordinates: [-33.8688, -51.2159], image: "https://images.unsplash.com/photo-1516627145497-ae6968895b2e?w=500&h=400&fit=crop", activities: ["Traditional dances", "Food", "Military parades"], significance: "Chilean Independence Day celebration"},
            {id: 38, name: "Carnival Barranquilla", country: "Colombia", continent: "Americas", month: 2, coordinates: [10.9639, -74.7964], image: "https://images.unsplash.com/photo-1459749411175-04bf5292ceea?w=500&h=400&fit=crop", activities: ["Street dances", "Music", "Costumes"], significance: "One of world's largest carnivals"},
            {id: 39, name: "Inti Raymi", country: "Peru", continent: "Americas", month: 6, coordinates: [-13.1939, -72.5460], image: "https://images.unsplash.com/photo-1517457373614-b7152f800fd1?w=500&h=400&fit=crop", activities: ["Historical reenactment", "Rituals", "Music and dance"], significance: "Ancient Incan sun festival"},
            {id: 40, name: "Australia Day", country: "Australia", continent: "Oceania", month: 1, coordinates: [-25.2744, 133.7751], image: "https://images.unsplash.com/photo-1489749798305-4fea3ba63d52?w=500&h=400&fit=crop", activities: ["Barbecues", "Fireworks", "Concerts"], significance: "Australian National Day celebration"},
            {id: 41, name: "Vivid Sydney", country: "Australia", continent: "Oceania", month: 5, coordinates: [-33.8568, 151.2153], image: "https://images.unsplash.com/photo-1514565131-fce0801e5785?w=500&h=400&fit=crop", activities: ["Light installations", "Music", "Art exhibitions"], significance: "World's largest light festival"},
            {id: 42, name: "Maori Festival", country: "New Zealand", continent: "Oceania", month: 2, coordinates: [-41.2865, 174.7762], image: "https://images.unsplash.com/photo-1493515172519-5e4e6373ae0e?w=500&h=400&fit=crop", activities: ["Cultural performances", "Haka", "Traditional food"], significance: "Celebration of Maori culture and heritage"},
            {id: 43, name: "Festival Islands Fiji", country: "Fiji", continent: "Oceania", month: 8, coordinates: [-17.7134, 178.0650], image: "https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=500&h=400&fit=crop", activities: ["Traditional music", "Dance", "Crafts"], significance: "Celebration of Fijian culture"},
            {id: 44, name: "Surfing Championships", country: "Australia", continent: "Oceania", month: 3, coordinates: [-28.6597, 153.5507], image: "https://images.unsplash.com/photo-1505228395891-9a51e7e86e81?w=500&h=400&fit=crop", activities: ["Surfing competitions", "Beach culture", "Exhibitions"], significance: "Major international surfing event"},
            {id: 45, name: "Polynesian Festival", country: "Samoa", continent: "Oceania", month: 7, coordinates: [-13.6176, -172.1052], image: "https://images.unsplash.com/photo-1496442226666-8d4d0e62e6e9?w=500&h=400&fit=crop", activities: ["Traditional dances", "Sports", "Cultural displays"], significance: "Annual celebration of Polynesian cultures"},
            {id: 46, name: "Haro Wine Festival", country: "Spain", continent: "Europe", month: 6, coordinates: [42.2758, -2.8157], image: "https://images.unsplash.com/photo-1514306688737-6ad76b1991c5?w=500&h=400&fit=crop", activities: ["Wine spraying", "Parades", "Dancing"], significance: "Spanish wine festival celebration"},
            {id: 47, name: "Pushkar Camel Fair", country: "India", continent: "Asia", month: 10, coordinates: [26.4923, 74.5505], image: "https://images.unsplash.com/photo-1549317661-bd32c8e6e770?w=500&h=400&fit=crop", activities: ["Camel trading", "Religious rituals", "Folk performances"], significance: "Annual Hindu pilgrimage and camel fair"},
            {id: 48, name: "Harbin Ice Festival", country: "China", continent: "Asia", month: 1, coordinates: [45.8038, 126.5340], image: "https://images.unsplash.com/photo-1514525253161-7a46d19cd819?w=500&h=400&fit=crop", activities: ["Ice sculptures", "Winter sports", "Performances"], significance: "Spectacular ice and snow art festival"},
            {id: 49, name: "Biennale Venice", country: "Italy", continent: "Europe", month: 5, coordinates: [45.4408, 12.3155], image: "https://images.unsplash.com/photo-1578905455847-267181db3fcd?w=500&h=400&fit=crop", activities: ["Art exhibitions", "Performances", "Installations"], significance: "International contemporary art exhibition"},
            {id: 50, name: "Cannes Film Festival", country: "France", continent: "Europe", month: 5, coordinates: [43.5528, 7.0176], image: "https://images.unsplash.com/photo-1489749798305-4fea3ba63d60?w=500&h=400&fit=crop", activities: ["Film screenings", "Red carpet events", "Networking"], significance: "One of the most prestigious film festivals"}
        ];

        // Global state
        let currentPage = 1;
        const festivalsPerPage = 9;
        let filteredFestivals = [...festivals];
        let map = null;
        let markers = null;
        let currentFestival = null;
        let favorites = [];
        let planner = [];
        let newsletterShown = false;
        const monthNames = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
        
        // Category icons mapping
        const categoryIcons = {
            "Religion & Spirituality": "fa-om",
            "Music & Arts": "fa-music",
            "Food & Harvest": "fa-leaf",
            "Traditional & Cultural": "fa-landmark",
            "Adventure & Sports": "fa-person-running",
            "Film & Theater": "fa-film",
            "Technology & Innovation": "fa-microchip"
        };

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            initializeFeaturedFestivals();
            initializeGallery();
            initializeTimeline();
            initializeCompareSelects();
            
            // Add enter key support for search
            document.getElementById('globalSearch').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });

            // Back to top button
            window.addEventListener('scroll', function() {
                const backToTop = document.getElementById('backToTop');
                if (window.pageYOffset > 300) {
                    backToTop.classList.add('show');
                } else {
                    backToTop.classList.remove('show');
                }
            });

            // Show newsletter modal after 10 seconds
            setTimeout(function() {
                if (!newsletterShown) {
                    showNewsletterModal();
                }
            }, 10000);
        });

        // Back to top function
        function scrollToTop() {
            window.scrollTo({
                top: 0,
                behavior: 'smooth'
            });
        }

        // Page Navigation
        function showPage(pageName) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));
            
            if (pageName === 'home') {
                document.getElementById('home').classList.add('active');
                navLinks[0].classList.add('active');
            } else if (pageName === 'gallery') {
                document.getElementById('gallery').classList.add('active');
                navLinks[1].classList.add('active');
                renderGallery();
            } else if (pageName === 'timeline') {
                document.getElementById('timeline').classList.add('active');
                navLinks[2].classList.add('active');
            } else if (pageName === 'map') {
                document.getElementById('map-page').classList.add('active');
                navLinks[3].classList.add('active');
                setTimeout(() => initializeMap(), 100);
            } else if (pageName === 'compare') {
                document.getElementById('compare').classList.add('active');
                navLinks[4].classList.add('active');
            } else if (pageName === 'favorites') {
                document.getElementById('favorites').classList.add('active');
                navLinks[5].classList.add('active');
                renderFavorites();
            } else if (pageName === 'planner') {
                document.getElementById('planner').classList.add('active');
                navLinks[6].classList.add('active');
                renderPlanner();
            }
            
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        // Featured Festivals
        function initializeFeaturedFestivals() {
            const featuredContainer = document.getElementById('featuredFestivals');
            const featured = [festivals[0], festivals[15], festivals[30], festivals[40]];
            featuredContainer.innerHTML = featured.map(festival => createFestivalCard(festival)).join('');
        }

        // Festival Card with enhanced features
        function createFestivalCard(festival) {
            const isFavorite = favorites.includes(festival.id);
            const isPlanned = planner.includes(festival.id);
            const categoryIcon = categoryIcons[festival.category] || 'fa-star';
            
            return `
                <div class="festival-card" style="position: relative;">
                    <div style="position: relative;">
                        <img src="${festival.image}" alt="${festival.name}" class="festival-image" onerror="this.src='https://images.unsplash.com/photo-1533900298318-6b8da08a523e?w=500&h=400&fit=crop'" onclick="showFestivalDetail(${festival.id})">
                        <div class="category-badge">
                            <i class="fas ${categoryIcon}"></i> ${festival.category}
                        </div>
                        <button class="favorite-btn ${isFavorite ? 'active' : ''}" onclick="toggleFavorite(event, ${festival.id})">
                            <i class="fas fa-heart"></i>
                        </button>
                    </div>
                    <div class="festival-content" onclick="showFestivalDetail(${festival.id})">
                        <h3 class="festival-name">${festival.name}</h3>
                        <div class="festival-location">
                            <i class="fas fa-map-marker-alt"></i> ${festival.country}
                        </div>
                        <div>
                            <span class="festival-month"><i class="fas fa-calendar"></i> ${monthNames[festival.month - 1]}</span>
                            <span class="continent-badge continent-${festival.continent.toLowerCase()}">${festival.continent}</span>
                        </div>
                        <p class="festival-description">${festival.significance}</p>
                        <div style="margin-top: 1rem; display: flex; gap: 0.5rem;">
                            <button class="btn btn-primary" style="flex: 1; padding: 0.5rem; font-size: 0.85rem;" onclick="event.stopPropagation(); ${isPlanned ? 'removeFromPlanner' : 'addToPlanner'}(${festival.id})">
                                <i class="fas ${isPlanned ? 'fa-check' : 'fa-plus'}"></i> ${isPlanned ? 'Planned' : 'Plan'}
                            </button>
                        </div>
                    </div>
                </div>
            `;
        }

        // Gallery
        function initializeGallery() {
            filteredFestivals = [...festivals];
            currentPage = 1;
            renderGallery();
        }

        function applyFilters() {
            const continent = document.getElementById('continentFilter').value;
            const month = document.getElementById('monthFilter').value;
            
            filteredFestivals = festivals.filter(festival => {
                const continentMatch = continent === 'all' || festival.continent === continent;
                const monthMatch = month === 'all' || festival.month === parseInt(month);
                return continentMatch && monthMatch;
            });
            
            currentPage = 1;
            renderGallery();
        }

        function renderGallery() {
            const container = document.getElementById('galleryFestivals');
            const startIdx = (currentPage - 1) * festivalsPerPage;
            const endIdx = startIdx + festivalsPerPage;
            const pageFestivals = filteredFestivals.slice(startIdx, endIdx);
            
            container.innerHTML = pageFestivals.map(festival => createFestivalCard(festival)).join('');
            renderPagination();
        }

        function renderPagination() {
            const totalPages = Math.ceil(filteredFestivals.length / festivalsPerPage);
            const container = document.getElementById('pagination');
            
            let html = `
                <button class="pagination-btn" onclick="changePage(${currentPage - 1})" ${currentPage === 1 ? 'disabled' : ''}>
                    &laquo; Previous
                </button>
            `;
            
            for (let i = 1; i <= totalPages; i++) {
                html += `
                    <button class="pagination-btn ${i === currentPage ? 'active' : ''}" onclick="changePage(${i})">
                        ${i}
                    </button>
                `;
            }
            
            html += `
                <button class="pagination-btn" onclick="changePage(${currentPage + 1})" ${currentPage === totalPages ? 'disabled' : ''}>
                    Next &raquo;
                </button>
            `;
            
            container.innerHTML = html;
        }

        function changePage(page) {
            const totalPages = Math.ceil(filteredFestivals.length / festivalsPerPage);
            if (page < 1 || page > totalPages) return;
            currentPage = page;
            renderGallery();
            window.scrollTo({top: 0, behavior: 'smooth'});
        }

        // Timeline
        function initializeTimeline() {
            const container = document.getElementById('timelineContent');
            const festivalsByMonth = {};
            
            for (let i = 1; i <= 12; i++) {
                festivalsByMonth[i] = festivals.filter(f => f.month === i);
            }
            
            let html = '';
            for (let month = 1; month <= 12; month++) {
                const monthFestivals = festivalsByMonth[month];
                if (monthFestivals.length > 0) {
                    html += `
                        <div class="timeline-month">
                            <h3 class="month-header">${monthNames[month - 1]}</h3>
                            <div class="timeline-items">
                                ${monthFestivals.map(festival => `
                                    <div class="timeline-item" onclick="showFestivalDetail(${festival.id})">
                                        <div class="timeline-item-name">${festival.name}</div>
                                        <div class="timeline-item-location">${festival.country}, ${festival.continent}</div>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                }
            }
            
            container.innerHTML = html;
        }

        // Map
        function initializeMap() {
            if (map) {
                map.remove();
            }
            
            map = L.map('map').setView([20, 0], 2);
            
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '© OpenStreetMap contributors',
                maxZoom: 18
            }).addTo(map);
            
            markers = L.markerClusterGroup();
            
            festivals.forEach(festival => {
                const marker = L.marker(festival.coordinates)
                    .bindPopup(`
                        <div class="popup-content">
                            <h4>${festival.name}</h4>
                            <p>${festival.country}</p>
                            <p>${monthNames[festival.month - 1]}</p>
                            <button class="popup-btn" onclick="showFestivalDetail(${festival.id})">View Details</button>
                        </div>
                    `);
                marker.festivalData = festival;
                markers.addLayer(marker);
            });
            
            map.addLayer(markers);
        }

        function filterMapMarkers() {
            const continent = document.getElementById('mapContinentFilter').value;
            
            markers.clearLayers();
            
            const filtered = continent === 'all' 
                ? festivals 
                : festivals.filter(f => f.continent === continent);
            
            filtered.forEach(festival => {
                const marker = L.marker(festival.coordinates)
                    .bindPopup(`
                        <div class="popup-content">
                            <h4>${festival.name}</h4>
                            <p>${festival.country}</p>
                            <p>${monthNames[festival.month - 1]}</p>
                            <button class="popup-btn" onclick="showFestivalDetail(${festival.id})">View Details</button>
                        </div>
                    `);
                marker.festivalData = festival;
                markers.addLayer(marker);
            });
        }

        // Search
        function performSearch() {
            const searchTerm = document.getElementById('globalSearch').value.toLowerCase().trim();
            
            if (!searchTerm) {
                alert('Please enter a search term');
                return;
            }
            
            const results = festivals.filter(festival => {
                return festival.name.toLowerCase().includes(searchTerm) ||
                       festival.country.toLowerCase().includes(searchTerm) ||
                       monthNames[festival.month - 1].toLowerCase().includes(searchTerm) ||
                       festival.continent.toLowerCase().includes(searchTerm);
            });
            
            displaySearchResults(results, searchTerm);
        }

        function displaySearchResults(results, searchTerm) {
            const pages = document.querySelectorAll('.page');
            pages.forEach(page => page.classList.remove('active'));
            document.getElementById('search-results').classList.add('active');
            
            const navLinks = document.querySelectorAll('.nav-link');
            navLinks.forEach(link => link.classList.remove('active'));
            
            document.getElementById('searchTerm').textContent = searchTerm;
            const container = document.getElementById('searchResultsGrid');
            
            if (results.length === 0) {
                container.innerHTML = '<div class="no-results">No festivals found matching your search.</div>';
            } else {
                container.innerHTML = results.map(festival => createFestivalCard(festival)).join('');
            }
        }

        // Festival Detail Modal
        function showFestivalDetail(festivalId) {
            const festival = festivals.find(f => f.id === festivalId);
            if (!festival) return;
            
            currentFestival = festival;
            
            document.getElementById('modalImage').src = festival.image;
            document.getElementById('modalTitle').textContent = festival.name;
            document.getElementById('modalCountry').textContent = festival.country;
            document.getElementById('modalContinent').textContent = festival.continent;
            document.getElementById('modalMonth').textContent = monthNames[festival.month - 1];
            document.getElementById('modalCoordinates').textContent = `${festival.coordinates[0].toFixed(4)}, ${festival.coordinates[1].toFixed(4)}`;
            document.getElementById('modalSignificance').textContent = festival.significance;
            
            const activitiesHtml = festival.activities.map(activity => 
                `<span class="activity-tag">${activity}</span>`
            ).join('');
            document.getElementById('modalActivities').innerHTML = activitiesHtml;
            
            document.getElementById('festivalModal').classList.add('active');
        }

        function closeModal() {
            document.getElementById('festivalModal').classList.remove('active');
        }

        function showOnMap() {
            closeModal();
            showPage('map');
            setTimeout(() => {
                if (currentFestival) {
                    map.setView(currentFestival.coordinates, 6);
                }
            }, 300);
        }

        // Compare
        function initializeCompareSelects() {
            const selects = ['compare1', 'compare2', 'compare3'];
            selects.forEach(selectId => {
                const select = document.getElementById(selectId);
                festivals.forEach(festival => {
                    const option = document.createElement('option');
                    option.value = festival.id;
                    option.textContent = `${festival.name} (${festival.country})`;
                    select.appendChild(option);
                });
            });
        }

        function updateComparison() {
            const ids = [
                document.getElementById('compare1').value,
                document.getElementById('compare2').value,
                document.getElementById('compare3').value
            ].filter(id => id);
            
            if (ids.length < 2) {
                document.getElementById('comparisonTable').innerHTML = '<p style="padding: 2rem; text-align: center;">Please select at least 2 festivals to compare.</p>';
                return;
            }
            
            const selectedFestivals = ids.map(id => festivals.find(f => f.id === parseInt(id)));
            
            let html = '<table><thead><tr><th>Attribute</th>';
            selectedFestivals.forEach(festival => {
                html += `<th>${festival.name}</th>`;
            });
            html += '</tr></thead><tbody>';
            
            const attributes = [
                {label: 'Country', key: 'country'},
                {label: 'Continent', key: 'continent'},
                {label: 'Month', key: 'month', format: (val) => monthNames[val - 1]},
                {label: 'Significance', key: 'significance'},
                {label: 'Activities', key: 'activities', format: (val) => val.join(', ')}
            ];
            
            attributes.forEach(attr => {
                html += `<tr><td><strong>${attr.label}</strong></td>`;
                selectedFestivals.forEach(festival => {
                    const value = attr.format ? attr.format(festival[attr.key]) : festival[attr.key];
                    html += `<td>${value}</td>`;
                });
                html += '</tr>';
            });
            
            html += '</tbody></table>';
            document.getElementById('comparisonTable').innerHTML = html;
        }

        // Favorites functionality
        function toggleFavorite(event, festivalId) {
            event.stopPropagation();
            const index = favorites.indexOf(festivalId);
            
            if (index > -1) {
                favorites.splice(index, 1);
                showToast('Removed from favorites', 'info');
            } else {
                favorites.push(festivalId);
                showToast('Added to favorites! ❤️', 'success');
            }
            
            // Refresh current view
            const activePage = document.querySelector('.page.active');
            if (activePage.id === 'gallery') {
                renderGallery();
            } else if (activePage.id === 'home') {
                initializeFeaturedFestivals();
            } else if (activePage.id === 'favorites') {
                renderFavorites();
            } else if (activePage.id === 'search-results') {
                const searchTerm = document.getElementById('searchTerm').textContent;
                const results = festivals.filter(f => {
                    return f.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                           f.country.toLowerCase().includes(searchTerm.toLowerCase()) ||
                           monthNames[f.month - 1].toLowerCase().includes(searchTerm.toLowerCase());
                });
                document.getElementById('searchResultsGrid').innerHTML = results.map(f => createFestivalCard(f)).join('');
            }
        }

        function renderFavorites() {
            const container = document.getElementById('favoritesGrid');
            
            if (favorites.length === 0) {
                container.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 4rem 2rem;">
                        <i class="fas fa-heart" style="font-size: 4rem; color: var(--accent-purple); opacity: 0.3; margin-bottom: 1rem;"></i>
                        <h3 style="color: var(--gray-text); margin-bottom: 0.5rem;">No favorites yet</h3>
                        <p style="color: var(--gray-text);">Start adding festivals to your favorites by clicking the heart icon!</p>
                        <button class="btn btn-primary" onclick="showPage('gallery')" style="margin-top: 1.5rem;">Browse Festivals</button>
                    </div>
                `;
                return;
            }
            
            const favoriteFestivals = festivals.filter(f => favorites.includes(f.id));
            container.innerHTML = favoriteFestivals.map(festival => createFestivalCard(festival)).join('');
        }

        // Planner functionality
        function addToPlanner(festivalId) {
            if (!planner.includes(festivalId)) {
                planner.push(festivalId);
                showToast('Added to planner! 📅', 'success');
                renderGallery();
                updatePlannerStats();
            }
        }

        function removeFromPlanner(festivalId) {
            const index = planner.indexOf(festivalId);
            if (index > -1) {
                planner.splice(index, 1);
                showToast('Removed from planner', 'info');
                renderGallery();
                renderPlanner();
                updatePlannerStats();
            }
        }

        function renderPlanner() {
            const container = document.getElementById('plannerGrid');
            
            if (planner.length === 0) {
                container.innerHTML = `
                    <div style="grid-column: 1 / -1; text-align: center; padding: 4rem 2rem;">
                        <i class="fas fa-calendar-check" style="font-size: 4rem; color: var(--accent-purple); opacity: 0.3; margin-bottom: 1rem;"></i>
                        <h3 style="color: var(--gray-text); margin-bottom: 0.5rem;">No festivals planned yet</h3>
                        <p style="color: var(--gray-text);">Start planning your festival journey!</p>
                        <button class="btn btn-primary" onclick="showPage('gallery')" style="margin-top: 1.5rem;">Browse Festivals</button>
                    </div>
                `;
                return;
            }
            
            const plannedFestivals = festivals.filter(f => planner.includes(f.id));
            // Sort by month
            plannedFestivals.sort((a, b) => a.month - b.month);
            container.innerHTML = plannedFestivals.map(festival => createFestivalCard(festival)).join('');
            updatePlannerStats();
        }

        function updatePlannerStats() {
            const plannedFestivals = festivals.filter(f => planner.includes(f.id));
            const uniqueCountries = new Set(plannedFestivals.map(f => f.country));
            const uniqueContinents = new Set(plannedFestivals.map(f => f.continent));
            
            document.getElementById('plannedCount').textContent = plannedFestivals.length;
            document.getElementById('countriesCount').textContent = uniqueCountries.size;
            document.getElementById('continentsCount').textContent = uniqueContinents.size;
        }

        // Newsletter modal
        function showNewsletterModal() {
            if (!newsletterShown) {
                document.getElementById('newsletterModal').classList.add('active');
                newsletterShown = true;
            }
        }

        function closeNewsletterModal() {
            document.getElementById('newsletterModal').classList.remove('active');
        }

        function subscribeNewsletter() {
            const email = document.getElementById('newsletterEmail').value;
            if (email && email.includes('@')) {
                showToast('Thank you for subscribing! 🎉', 'success');
                closeNewsletterModal();
            } else {
                showToast('Please enter a valid email address', 'error');
            }
        }

        // Toast notification
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.style.cssText = `
                position: fixed;
                top: 100px;
                right: 20px;
                background: ${type === 'success' ? 'linear-gradient(135deg, #1E7E34, #2E7D32)' : type === 'error' ? 'linear-gradient(135deg, #C00015, #FF5459)' : 'linear-gradient(135deg, var(--primary-purple), var(--accent-purple))'};
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 12px;
                box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
                z-index: 10000;
                font-weight: 600;
                animation: slideInRight 0.3s ease-out;
            `;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.style.animation = 'slideOutRight 0.3s ease-out';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // Close modal on outside click
        window.onclick = function(event) {
            const modal = document.getElementById('festivalModal');
            if (event.target === modal) {
                closeModal();
            }
            const newsletterModal = document.getElementById('newsletterModal');
            if (event.target === newsletterModal) {
                closeNewsletterModal();
            }
        }
        // Add CSS animations for toast
        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideInRight {
                from {
                    transform: translateX(400px);
                    opacity: 0;
                }
                to {
                    transform: translateX(0);
                    opacity: 1;
                }
            }
            @keyframes slideOutRight {
                from {
                    transform: translateX(0);
                    opacity: 1;
                }
                to {
                    transform: translateX(400px);
                    opacity: 0;
                }
            }
        `;
        document.head.appendChild(style);

        // Add rating display to festival data (simulated)
        festivals.forEach(festival => {
            if (!festival.rating) {
                festival.rating = (4.5 + Math.random() * 0.5).toFixed(1);
            }
            if (!festival.difficulty) {
                const difficulties = ['Easy', 'Medium', 'Hard'];
                festival.difficulty = difficulties[Math.floor(Math.random() * 3)];
            }
            if (!festival.category) {
                const categories = Object.keys(categoryIcons);
                festival.category = categories[Math.floor(Math.random() * categories.length)];
            }
        });
    </script>
</body>
</html>
